<!--components/email/email.wxml-->
<view wx:if="{{show}}" class="email-component">
  <!-- é‚®ç®±çŠ¶æ€æ˜¾ç¤ºåŒºåŸŸ -->
  <view class="email-status {{isCardActive ? 'active' : ''}}" bindtouchstart="onCardTouchStart" bindtouchend="onCardTouchEnd" bindtap="onCardTap">
    <view class="email-info">
      <text class="email-icon">ğŸ“§</text>
      <view class="email-details">
        <text class="email-label">é‚®ç®±</text>
        <text class="email-value">{{currentEmail || 'æœªè®¾ç½®'}}</text>
      </view>
    </view>
    <view class="email-actions">
      <view 
        wx:if="{{!showOperation}}"
        class="action-button {{currentEmail ? 'danger' : ''}}" 
        bindtap="onStartOperation"
      >
        {{currentEmail ? 'è§£ç»‘' : 'ç»‘å®š'}}
      </view>
    </view>
  </view>

  <!-- æ“ä½œç•Œé¢ -->
  <view wx:if="{{showOperation}}" class="email-operation">
    <view class="operation-header">
      <text class="operation-title">
        {{isAssociationMode ? 'å…³è”é‚®ç®±' : (action === 'bind' ? 'ç»‘å®šé‚®ç®±' : 'è§£ç»‘é‚®ç®±')}}
      </text>
      <view class="operation-close" bindtap="onCancelOperation">âœ•</view>
    </view>

    <view class="operation-body">
      <!-- é‚®ç®±è¾“å…¥åŒºåŸŸ -->
      <view class="input-group">
        <text class="input-label">é‚®ç®±åœ°å€</text>
        <input
          class="email-input {{action === 'bind' ? '' : 'readonly'}}"
          type="text"
          value="{{email}}"
          placeholder="{{action === 'bind' ? 'è¯·è¾“å…¥é‚®ç®±åœ°å€' : ''}}"
          disabled="{{action === 'unbind'}}"
          bindinput="onEmailInput"
        />
        <view wx:if="{{action === 'bind'}}" class="email-validation">
          <text wx:if="{{email && !isValidEmail}}" class="validation-text invalid">é‚®ç®±æ ¼å¼ä¸æ­£ç¡®</text>
          <text wx:if="{{email && isValidEmail}}" class="validation-text valid">é‚®ç®±æ ¼å¼æ­£ç¡®</text>
        </view>
      </view>

      <!-- éªŒè¯ç è¾“å…¥åŒºåŸŸ -->
      <view class="input-group">
        <text class="input-label">éªŒè¯ç </text>
        <view class="code-input-container">
          <input
            class="code-input"
            type="text"
            value="{{verificationCode}}"
            placeholder="è¯·è¾“å…¥éªŒè¯ç "
            bindinput="onVerificationCodeInput"
          />
          <view
            class="send-code-btn {{sendCodeBtnDisabled ? 'disabled' : ''}}"
            bindtap="onSendVerificationCode"
          >
            {{sendCodeBtnText}}
          </view>
        </view>
      </view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="operation-footer">
      <view class="cancel-btn" bindtap="onCancelOperation">å–æ¶ˆ</view>
      <view class="confirm-btn" bindtap="onConfirm">{{isAssociationMode ? 'å…³è”' : 'ç¡®è®¤'}}</view>
    </view>
  </view>
</view>